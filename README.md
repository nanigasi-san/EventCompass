# EventCompass

オリエンテーリング大会運営用のオフライン動作管理アプリ。

## セットアップ

Python 3.12 以上を用意し、以下のコマンドで依存関係をインストールしてください。パッケージの取得には
`uv` を利用します。

```bash
uv sync
```

## サーバーの起動方法

開発用サーバーは `uvicorn` を利用して起動します。リポジトリルートで次のコマンドを実行してください。

```bash
uv run uvicorn backend.main:app --reload
```

デフォルトでは `http://127.0.0.1:8000` で待ち受けます。SQLite データベースファイルは初回起動時に `backend/eventcompass.db` として自動生成されます。

## フロントエンド (PWA) の開発

ローカルの FastAPI サーバーと連携するオフライン対応 SPA を `frontend/` ディレクトリに追加しています。初回のみ依存関係をインストールしてください。

```bash
cd frontend
npm install
```

開発サーバーは以下で起動します。バックエンドと合わせて立ち上げると、`http://127.0.0.1:5173` からアプリを操作できます。

```bash
npm run dev
```

PWA としてインストールする場合や本番ビルドを作成する場合は次のコマンドを利用します。

```bash
npm run build
npm run preview
```

IndexedDB によるローカルキャッシュとサービスワーカーを備えており、オフライン時はキャッシュされたデータと保留中の変更を保持します。オンラインに戻った際や「今すぐ同期」ボタンを押した際に差分が FastAPI サーバーへ送信されます。

## API ドキュメント

サーバー起動後、ブラウザで以下にアクセスすると API ドキュメントを確認できます。

- Swagger UI: <http://127.0.0.1:8000/docs>
- ReDoc: <http://127.0.0.1:8000/redoc>

## テストと静的解析

開発用依存関係をインストール済みであれば、以下のコマンドで品質チェックを実行できます。

```bash
uv run pytest
uv run ruff check .
```
